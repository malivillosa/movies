import{t as A,a as E,n as H,b as g,i as x,c as L,d as T,e as I,M as Y}from"./MovieCard-DZDqWUgY.js";import{w as h,r as v,t as p,c as O,o as C,g as F,_ as X,a as W,b as M,F as $,d as j,e as R,u as q,M as z,f as _,h as G}from"./index-AlcpExzM.js";const S=x?window:void 0;function y(e){var t;const n=p(e);return(t=n==null?void 0:n.$el)!=null?t:n}function J(...e){let t,n,s,r;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,s,r]=e,t=S):[t,n,s,r]=e,!t)return g;n=E(n),s=E(s);const i=[],c=()=>{i.forEach(l=>l()),i.length=0},o=(l,f,m,d)=>(l.addEventListener(f,m,d),()=>l.removeEventListener(f,m,d)),u=h(()=>[y(t),p(r)],([l,f])=>{if(c(),!l)return;const m=T(f)?{...f}:f;i.push(...n.flatMap(d=>s.map(w=>o(l,d,w,m))))},{immediate:!0,flush:"post"}),a=()=>{u(),c()};return I(a),a}function K(){const e=v(!1),t=F();return t&&C(()=>{e.value=!0},t),e}function Q(e){const t=K();return O(()=>(t.value,!!e()))}function U(e,t,n={}){const{root:s,rootMargin:r="0px",threshold:i=0,window:c=S,immediate:o=!0}=n,u=Q(()=>c&&"IntersectionObserver"in c),a=O(()=>{const w=p(e);return E(w).map(y).filter(H)});let l=g;const f=v(o),m=u.value?h(()=>[a.value,y(s),f.value],([w,P])=>{if(l(),!f.value||!w.length)return;const V=new IntersectionObserver(t,{root:y(P),rootMargin:r,threshold:i});w.forEach(D=>D&&V.observe(D)),l=()=>{V.disconnect(),l=g}},{immediate:o,flush:"post"}):g,d=()=>{l(),m(),f.value=!1};return I(d),{isSupported:u,isActive:f,pause(){l(),f.value=!1},resume(){f.value=!0},stop:d}}function B(e,t={}){const{window:n=S,scrollTarget:s,threshold:r=0,rootMargin:i}=t,c=v(!1);return U(e,o=>{let u=c.value,a=0;for(const l of o)l.time>=a&&(a=l.time,u=l.isIntersecting);c.value=u},{root:s,window:n,threshold:r,rootMargin:p(i)}),c}const Z={mounted(e,t){if(typeof t.value=="function"){const n=t.value,s=B(e);h(s,r=>n(r),{immediate:!0})}else{const[n,s]=t.value,r=B(e,s);h(r,i=>n(i),{immediate:!0})}}};function b(e){return typeof Window<"u"&&e instanceof Window?e.document.documentElement:typeof Document<"u"&&e instanceof Document?e.documentElement:e}function N(e){const t=window.getComputedStyle(e);if(t.overflowX==="scroll"||t.overflowY==="scroll"||t.overflowX==="auto"&&e.clientWidth<e.scrollWidth||t.overflowY==="auto"&&e.clientHeight<e.scrollHeight)return!0;{const n=e.parentNode;return!n||n.tagName==="BODY"?!1:N(n)}}function ee(e){const t=e||window.event,n=t.target;return N(n)?!1:t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)}const k=new WeakMap;function te(e,t=!1){const n=v(t);let s=null,r="";h(A(e),o=>{const u=b(p(o));if(u){const a=u;if(k.get(a)||k.set(a,a.style.overflow),a.style.overflow!=="hidden"&&(r=a.style.overflow),a.style.overflow==="hidden")return n.value=!0;if(n.value)return a.style.overflow="hidden"}},{immediate:!0});const i=()=>{const o=b(p(e));!o||n.value||(L&&(s=J(o,"touchmove",u=>{ee(u)},{passive:!1})),o.style.overflow="hidden",n.value=!0)},c=()=>{const o=b(p(e));!o||!n.value||(L&&(s==null||s()),o.style.overflow=r,k.delete(o),n.value=!1)};return I(c),O({get(){return n.value},set(o){o?i():c()}})}function ne(){let e=!1;const t=v(!1);return(n,s)=>{if(t.value=s.value,e)return;e=!0;const r=te(n,s.value);h(t,i=>r.value=i)}}ne();const oe={class:"wrapper"},se={class:"movies-grid"},re={__name:"HomeView",setup(e){const t=new z,n=v([]),s=v(1),r=v(null),i=v(!1);C(async()=>{try{const o=await t.fetchPopularMovies();n.value=o.results,r.value=o.total_pages}catch(o){console.log(o)}});async function c(){if(!i.value){if(s.value<r.value)s.value+=1;else return;i.value=!0;try{const o=await t.fetchPopularMovies({page:s.value});n.value.push(...o.results),r.value=o.total_pages}catch(o){console.log(o)}finally{i.value=!1}}}return(o,u)=>(_(),W("div",oe,[u[1]||(u[1]=M("h1",{class:"title"},"Popular movies",-1)),M("div",se,[(_(!0),W($,null,j(n.value,a=>(_(),G(Y,{key:a.id,movie:a,onViewDetails:u[0]||(u[0]=l=>o.$emit("view-details",l))},null,8,["movie"]))),128)),R(M("div",null,null,512),[[q(Z),c]])])]))}},ie=X(re,[["__scopeId","data-v-bd4f8fb7"]]);export{ie as default};
